/**
 * Code Editor Base Styling
 *
 * Provides Bootstrap 5 integration styling for the Prism Code Editor component.
 * This CSS handles the "chrome" around the editor (borders, focus states, etc.)
 * while theme CSS files handle syntax highlighting colors.
 */

.shiny-input-code-editor {
  /* Required by Prism Code Editor */
  display: grid !important;

  /* Match Bootstrap form control styling */
  border: 1px solid var(--bs-border-color, #dee2e6);
  border-radius: var(--bs-border-radius, 0.375rem);
  background-color: var(--bs-body-bg, #fff);
  color: var(--bs-body-color, #212529);

  /* Ensure proper sizing */
  width: 100%;
  position: relative;
  overflow: hidden;

  /* Smooth transitions */
  transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

/* Focus state - matches Bootstrap input focus */
.shiny-input-code-editor:focus-within {
  border-color: var(--bs-primary, #0d6efd);
  outline: 0;
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

/* Dark mode adjustments */
[data-bs-theme="dark"] .shiny-input-code-editor {
  border-color: var(--bs-border-color, #495057);
  background-color: var(--bs-body-bg, #212529);
  color: var(--bs-body-color, #dee2e6);
}

[data-bs-theme="dark"] .shiny-input-code-editor:focus-within {
  border-color: var(--bs-primary, #0d6efd);
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

/* Submit flash animation (Ctrl/Cmd+Enter feedback) */
.code-editor-submit-flash {
  animation: code-editor-flash 0.2s ease-out;
}

@keyframes code-editor-flash {
  0% {
    border-color: var(--bs-success, #198754);
    box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.5);
  }
  100% {
    border-color: var(--bs-border-color, #dee2e6);
    box-shadow: none;
  }
}

/* Ensure copy button appears above code but below modals */
.shiny-input-code-editor .pce-copy-button {
  z-index: 10;
}

/* Placeholder styling when editor is empty */
.shiny-input-code-editor[data-placeholder]:not(.code-editor-has-content)::before {
  content: attr(data-placeholder);
  position: absolute;
  top: 0.5rem;
  left: 0.75rem;
  color: var(--bs-secondary-color, #6c757d);
  opacity: 0.65;
  font-style: italic;
  pointer-events: none;
  font-family: var(--bs-font-monospace, ui-monospace, "SFMono-Regular", "Menlo", "Monaco", "Consolas", "Liberation Mono", "Courier New", monospace);
}

/* Ensure proper font rendering */
.shiny-input-code-editor,
.shiny-input-code-editor textarea,
.shiny-input-code-editor pre,
.shiny-input-code-editor code {
  font-family: var(--bs-font-monospace, ui-monospace, "SFMono-Regular", "Menlo", "Monaco", "Consolas", "Liberation Mono", "Courier New", monospace);
  font-size: 0.875rem;
  line-height: 1.5;
}

/* Read-only state styling */
.shiny-input-code-editor[data-read-only="true"] {
  background-color: var(--bs-secondary-bg, #e9ecef);
  cursor: not-allowed;
}

[data-bs-theme="dark"] .shiny-input-code-editor[data-read-only="true"] {
  background-color: var(--bs-secondary-bg, #343a40);
}

/* Ensure textarea fills container properly */
.shiny-input-code-editor textarea {
  min-height: 100%;
}
