<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>QueryChat convenience functions — querychat • querychat</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="https://fonts.bunny.net/css?family=Open%20Sans:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="https://fonts.bunny.net/css?family=Hubot%20Sans:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="https://fonts.bunny.net/css?family=Source%20Code%20Pro:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="QueryChat convenience functions — querychat"><meta name="description" content="Convenience functions for wrapping QueryChat creation (i.e., querychat())
and app launching (i.e., querychat_app())."><meta property="og:description" content="Convenience functions for wrapping QueryChat creation (i.e., querychat())
and app launching (i.e., querychat_app())."><meta property="og:image" content="https://posit-dev.github.io/querychat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">querychat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/data-sources.html">Data Sources</a></li>
    <li><a class="dropdown-item" href="../articles/context.html">Provide context</a></li>
    <li><a class="dropdown-item" href="../articles/build.html">Build an app</a></li>
    <li><a class="dropdown-item" href="../articles/greet.html">Greet users</a></li>
    <li><a class="dropdown-item" href="../articles/tools.html">Tools</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/posit-dev/querychat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>QueryChat convenience functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/posit-dev/querychat/blob/main/R/QueryChat.R" class="external-link"><code>R/QueryChat.R</code></a></small>
      <div class="d-none name"><code>querychat-convenience.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Convenience functions for wrapping <a href="QueryChat.html">QueryChat</a> creation (i.e., <code>querychat()</code>)
and app launching (i.e., <code>querychat_app()</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">querychat</span><span class="op">(</span></span>
<span>  <span class="va">data_source</span>,</span>
<span>  table_name <span class="op">=</span> <span class="fu">missing_arg</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  greeting <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  client <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"update"</span>, <span class="st">"query"</span><span class="op">)</span>,</span>
<span>  data_description <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  categorical_threshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  extra_instructions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prompt_template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cleanup <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">querychat_app</span><span class="op">(</span></span>
<span>  <span class="va">data_source</span>,</span>
<span>  table_name <span class="op">=</span> <span class="fu">missing_arg</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  greeting <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  client <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"update"</span>, <span class="st">"query"</span><span class="op">)</span>,</span>
<span>  data_description <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  categorical_threshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  extra_instructions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prompt_template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cleanup <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  bookmark_store <span class="op">=</span> <span class="st">"url"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-source">data_source<a class="anchor" aria-label="anchor" href="#arg-data-source"></a></dt>
<dd><p>Either a data.frame or a database connection (e.g., DBI
connection).</p></dd>


<dt id="arg-table-name">table_name<a class="anchor" aria-label="anchor" href="#arg-table-name"></a></dt>
<dd><p>A string specifying the table name to use in SQL queries.
If <code>data_source</code> is a data.frame, this is the name to refer to it by in
queries (typically the variable name). If not provided, will be inferred
from the variable name for data.frame inputs. For database connections,
this parameter is required.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently unused).</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Optional module ID for the QueryChat instance. If not provided,
will be auto-generated from <code>table_name</code>. The ID is used to namespace
the Shiny module.</p></dd>


<dt id="arg-greeting">greeting<a class="anchor" aria-label="anchor" href="#arg-greeting"></a></dt>
<dd><p>Optional initial message to display to users. Can be a
character string (in Markdown format) or a file path. If not provided,
a greeting will be generated at the start of each conversation using the
LLM, which adds latency and cost. Use <code>$generate_greeting()</code> to create
a greeting to save and reuse.</p></dd>


<dt id="arg-client">client<a class="anchor" aria-label="anchor" href="#arg-client"></a></dt>
<dd><p>Optional chat client. Can be:</p><ul><li><p>An <a href="https://ellmer.tidyverse.org/reference/Chat.html" class="external-link">ellmer::Chat</a> object</p></li>
<li><p>A string to pass to <code><a href="https://ellmer.tidyverse.org/reference/chat-any.html" class="external-link">ellmer::chat()</a></code> (e.g., <code>"openai/gpt-4o"</code>)</p></li>
<li><p><code>NULL</code> (default): Uses the <code>querychat.client</code> option, the
<code>QUERYCHAT_CLIENT</code> environment variable, or defaults to
<code><a href="https://ellmer.tidyverse.org/reference/chat_openai.html" class="external-link">ellmer::chat_openai()</a></code></p></li>
</ul></dd>


<dt id="arg-tools">tools<a class="anchor" aria-label="anchor" href="#arg-tools"></a></dt>
<dd><p>Which querychat tools to include in the chat client, by
default. <code>"update"</code> includes the tools for updating and resetting the
dashboard and <code>"query"</code> includes the tool for executing SQL queries.
Use <code>tools = "update"</code> when you only want the dashboard updating tools,
or when you want to disable the querying tool entirely to prevent the
LLM from seeing any of the data in your dataset.</p></dd>


<dt id="arg-data-description">data_description<a class="anchor" aria-label="anchor" href="#arg-data-description"></a></dt>
<dd><p>Optional description of the data in plain text or
Markdown. Can be a string or a file path. This provides context to the
LLM about what the data represents.</p></dd>


<dt id="arg-categorical-threshold">categorical_threshold<a class="anchor" aria-label="anchor" href="#arg-categorical-threshold"></a></dt>
<dd><p>For text columns, the maximum number of unique
values to consider as a categorical variable. Default is 20.</p></dd>


<dt id="arg-extra-instructions">extra_instructions<a class="anchor" aria-label="anchor" href="#arg-extra-instructions"></a></dt>
<dd><p>Optional additional instructions for the chat
model in plain text or Markdown. Can be a string or a file path.</p></dd>


<dt id="arg-prompt-template">prompt_template<a class="anchor" aria-label="anchor" href="#arg-prompt-template"></a></dt>
<dd><p>Optional path to or string of a custom prompt
template file. If not provided, the default querychat template will be
used. See the package prompts directory for the default template format.</p></dd>


<dt id="arg-cleanup">cleanup<a class="anchor" aria-label="anchor" href="#arg-cleanup"></a></dt>
<dd><p>Whether or not to automatically run <code>$cleanup()</code> when the
Shiny session/app stops. By default, cleanup only occurs if <code>QueryChat</code>
is created within a Shiny app. Set to <code>TRUE</code> to always clean up, or
<code>FALSE</code> to never clean up automatically.</p>
<p>In <code>querychat_app()</code>, in-memory databases created for data frames are
always cleaned up.</p></dd>


<dt id="arg-bookmark-store">bookmark_store<a class="anchor" aria-label="anchor" href="#arg-bookmark-store"></a></dt>
<dd><p>The bookmarking storage method. Passed to
<code><a href="https://rdrr.io/pkg/shiny/man/enableBookmarking.html" class="external-link">shiny::enableBookmarking()</a></code>. If <code>"url"</code> or <code>"server"</code>, the chat state
(including current query) will be bookmarked. Default is <code>"url"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>QueryChat</code> object. See <a href="QueryChat.html">QueryChat</a> for available methods.</p>
<p>Invisibly returns the chat object after the app stops.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Quick start - chat with mtcars dataset in one line</span></span></span>
<span class="r-in"><span><span class="fu">querychat_app</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add options</span></span></span>
<span class="r-in"><span><span class="fu">querychat_app</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>  greeting <span class="op">=</span> <span class="st">"Welcome to the mtcars explorer!"</span>,</span></span>
<span class="r-in"><span>  client <span class="op">=</span> <span class="st">"openai/gpt-4o"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Chat with a database table (table_name required)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">":memory:"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"mtcars"</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">querychat_app</span><span class="op">(</span><span class="va">conn</span>, <span class="st">"mtcars"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create QueryChat class object</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="fu">querychat</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the app later</span></span></span>
<span class="r-in"><span><span class="va">qc</span><span class="op">$</span><span class="fu">app</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://garrickadenbuie.com" class="external-link">Garrick Aden-Buie</a>, <a href="https://github.com/jcheng5" class="external-link">Joe Cheng</a>, <a href="https://cpsievert.me" class="external-link">Carson Sievert</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

