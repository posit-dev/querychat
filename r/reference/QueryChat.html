<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>QueryChat: Interactive Data Querying with Natural Language — QueryChat • querychat</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="https://fonts.bunny.net/css?family=Open%20Sans:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="https://fonts.bunny.net/css?family=Hubot%20Sans:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="https://fonts.bunny.net/css?family=Source%20Code%20Pro:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=auto" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="QueryChat: Interactive Data Querying with Natural Language — QueryChat"><meta name="description" content="QueryChat is an R6 class built on Shiny, shinychat, and ellmer to enable
interactive querying of data using natural language. It leverages large
language models (LLMs) to translate user questions into SQL queries, execute
them against a data source (data frame or database), and various ways of
accessing/displaying the results."><meta property="og:description" content="QueryChat is an R6 class built on Shiny, shinychat, and ellmer to enable
interactive querying of data using natural language. It leverages large
language models (LLMs) to translate user questions into SQL queries, execute
them against a data source (data frame or database), and various ways of
accessing/displaying the results."><meta property="og:image" content="https://posit-dev.github.io/querychat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">querychat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/posit-dev/querychat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>QueryChat: Interactive Data Querying with Natural Language</h1>
      <small class="dont-index">Source: <a href="https://github.com/posit-dev/querychat/blob/main/R/QueryChat.R" class="external-link"><code>R/QueryChat.R</code></a></small>
      <div class="d-none name"><code>QueryChat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>QueryChat</code> is an R6 class built on Shiny, shinychat, and ellmer to enable
interactive querying of data using natural language. It leverages large
language models (LLMs) to translate user questions into SQL queries, execute
them against a data source (data frame or database), and various ways of
accessing/displaying the results.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>QueryChat</code> class takes your data (a data frame or database connection)
as input and provides methods to:</p><ul><li><p>Generate a chat UI for natural language queries (e.g., <code>$app()</code>, <code>$sidebar()</code>)</p></li>
<li><p>Initialize server logic that returns session-specific reactive values (via <code>$server()</code>)</p></li>
<li><p>Access reactive data, SQL queries, and titles through the returned server values</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h2>



<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://posit-dev.github.io/querychat/pkg-r">querychat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a QueryChat object</span></span>
<span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/QueryChat.html">QueryChat</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quick start: run a complete app</span></span>
<span><span class="va">qc</span><span class="op">$</span><span class="fu">app</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or build a custom Shiny app</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar</a></span><span class="op">(</span></span>
<span>  <span class="va">qc</span><span class="op">$</span><span class="fu">sidebar</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">"sql"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderDataTable.html" class="external-link">dataTableOutput</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">qc_vals</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">sql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="va">qc_vals</span><span class="op">$</span><span class="fu">sql</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderDataTable.html" class="external-link">renderDataTable</a></span><span class="op">(</span><span class="va">qc_vals</span><span class="op">$</span><span class="fu">df</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>greeting</code></dt>
<dd><p>The greeting message displayed to users.</p></dd>


<dt><code>id</code></dt>
<dd><p>ID for the QueryChat instance.</p></dd>


<dt><code>tools</code></dt>
<dd><p>The allowed tools for the chat client.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>system_prompt</code></dt>
<dd><p>Get the system prompt.</p></dd>


<dt><code>data_source</code></dt>
<dd><p>Get the current data source.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-QueryChat-new"><code>QueryChat$new()</code></a></p></li>
<li><p><a href="#method-QueryChat-client"><code>QueryChat$client()</code></a></p></li>
<li><p><a href="#method-QueryChat-console"><code>QueryChat$console()</code></a></p></li>
<li><p><a href="#method-QueryChat-app"><code>QueryChat$app()</code></a></p></li>
<li><p><a href="#method-QueryChat-app_obj"><code>QueryChat$app_obj()</code></a></p></li>
<li><p><a href="#method-QueryChat-sidebar"><code>QueryChat$sidebar()</code></a></p></li>
<li><p><a href="#method-QueryChat-ui"><code>QueryChat$ui()</code></a></p></li>
<li><p><a href="#method-QueryChat-server"><code>QueryChat$server()</code></a></p></li>
<li><p><a href="#method-QueryChat-generate_greeting"><code>QueryChat$generate_greeting()</code></a></p></li>
<li><p><a href="#method-QueryChat-cleanup"><code>QueryChat$cleanup()</code></a></p></li>
<li><p><a href="#method-QueryChat-clone"><code>QueryChat$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-QueryChat-new"></a><div class="section">
<h3 id="method-new-">Method <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new QueryChat object.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/QueryChat.html">QueryChat</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">data_source</span>,</span>
<span>  table_name <span class="op">=</span> <span class="fu">missing_arg</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  greeting <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  client <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tools <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"update"</span>, <span class="st">"query"</span><span class="op">)</span>,</span>
<span>  data_description <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  categorical_threshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  extra_instructions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prompt_template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cleanup <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data_source</code></dt>
<dd><p>Either a data.frame or a database connection (e.g., DBI
connection).</p></dd>


<dt><code>table_name</code></dt>
<dd><p>A string specifying the table name to use in SQL queries.
If <code>data_source</code> is a data.frame, this is the name to refer to it by in
queries (typically the variable name). If not provided, will be inferred
from the variable name for data.frame inputs. For database connections,
this parameter is required.</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments (currently unused).</p></dd>


<dt><code>id</code></dt>
<dd><p>Optional module ID for the QueryChat instance. If not provided,
will be auto-generated from <code>table_name</code>. The ID is used to namespace
the Shiny module.</p></dd>


<dt><code>greeting</code></dt>
<dd><p>Optional initial message to display to users. Can be a
character string (in Markdown format) or a file path. If not provided,
a greeting will be generated at the start of each conversation using the
LLM, which adds latency and cost. Use <code>$generate_greeting()</code> to create
a greeting to save and reuse.</p></dd>


<dt><code>client</code></dt>
<dd><p>Optional chat client. Can be:</p><ul><li><p>An <a href="https://ellmer.tidyverse.org/reference/Chat.html" class="external-link">ellmer::Chat</a> object</p></li>
<li><p>A string to pass to <code><a href="https://ellmer.tidyverse.org/reference/chat-any.html" class="external-link">ellmer::chat()</a></code> (e.g., <code>"openai/gpt-4o"</code>)</p></li>
<li><p><code>NULL</code> (default): Uses the <code>querychat.client</code> option, the
<code>QUERYCHAT_CLIENT</code> environment variable, or defaults to
<code><a href="https://ellmer.tidyverse.org/reference/chat_openai.html" class="external-link">ellmer::chat_openai()</a></code></p></li>
</ul></dd>


<dt><code>tools</code></dt>
<dd><p>Which querychat tools to include in the chat client, by
default. <code>"update"</code> includes the tools for updating and resetting the
dashboard and <code>"query"</code> includes the tool for executing SQL queries.
Use <code>tools = "update"</code> when you only want the dashboard updating tools,
or when you want to disable the querying tool entirely to prevent the
LLM from seeing any of the data in your dataset.</p></dd>


<dt><code>data_description</code></dt>
<dd><p>Optional description of the data in plain text or
Markdown. Can be a string or a file path. This provides context to the
LLM about what the data represents.</p></dd>


<dt><code>categorical_threshold</code></dt>
<dd><p>For text columns, the maximum number of unique
values to consider as a categorical variable. Default is 20.</p></dd>


<dt><code>extra_instructions</code></dt>
<dd><p>Optional additional instructions for the chat
model in plain text or Markdown. Can be a string or a file path.</p></dd>


<dt><code>prompt_template</code></dt>
<dd><p>Optional path to or string of a custom prompt
template file. If not provided, the default querychat template will be
used. See the package prompts directory for the default template format.</p></dd>


<dt><code>cleanup</code></dt>
<dd><p>Whether or not to automatically run <code>$cleanup()</code> when the
Shiny session/app stops. By default, cleanup only occurs if <code>QueryChat</code>
gets created within a Shiny session. Set to <code>TRUE</code> to always clean up,
or <code>FALSE</code> to never clean up automatically.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A new <code>QueryChat</code> object.</p>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
# Basic usage
qc &lt;- QueryChat$new(mtcars)

# With options
qc &lt;- QueryChat$new(
  mtcars,
  greeting = "Welcome to the mtcars explorer!",
  client = "openai/gpt-4o",
  data_description = "Motor Trend car road tests dataset"
)

# With database
library(DBI)
conn &lt;- dbConnect(RSQLite::SQLite(), ":memory:")
dbWriteTable(conn, "mtcars", mtcars)
qc &lt;- QueryChat$new(conn, "mtcars")
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-client"></a><div class="section">
<h3 id="method-client-">Method <code>client()</code><a class="anchor" aria-label="anchor" href="#method-client-"></a></h3>
<p>Create a chat client, complete with registered tools, for the current
data source.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">client</span><span class="op">(</span></span>
<span>  tools <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  update_dashboard <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span>, <span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="op">}</span>,</span>
<span>  reset_dashboard <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tools</code></dt>
<dd><p>Which querychat tools to include in the chat client.
<code>"update"</code> includes the tools for updating and resetting the dashboard
and <code>"query"</code> includes the tool for executing SQL queries. By default,
when <code>tools = NA</code>, the values provided at initialization are used.</p></dd>


<dt><code>update_dashboard</code></dt>
<dd><p>Optional function to call with the <code>query</code> and
<code>title</code> generated by the LLM for the <code>update_dashboard</code> tool.</p></dd>


<dt><code>reset_dashboard</code></dt>
<dd><p>Optional function to call when the
<code>reset_dashboard</code> tool is called.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-QueryChat-console"></a><div class="section">
<h3 id="method-console-">Method <code>console()</code><a class="anchor" aria-label="anchor" href="#method-console-"></a></h3>
<p>Launch a console-based chat interface with the data source.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">console</span><span class="op">(</span>new <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span>, tools <span class="op">=</span> <span class="st">"query"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>new</code></dt>
<dd><p>Whether to create a new chat client instance or continue the
conversation from the last console chat session (the default).</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments passed to the <code>$client()</code> method.</p></dd>


<dt><code>tools</code></dt>
<dd><p>Which querychat tools to include in the chat client. See
<code>$client()</code> for details. Ignored when not creating a new chat client.
By default, only the <code>"query"</code> tool is included, regardless of the
<code>tools</code> set at initialization.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-QueryChat-app"></a><div class="section">
<h3 id="method-app-">Method <code>app()</code><a class="anchor" aria-label="anchor" href="#method-app-"></a></h3>
<p>Create and run a Shiny gadget for chatting with data</p>
<p>Runs a Shiny gadget (designed for interactive use) that provides
a complete interface for chatting with your data using natural language.
If you're looking to deploy this app or run it through some other means,
see <code>$app_obj()</code>.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">app</span><span class="op">(</span><span class="va">...</span>, bookmark_store <span class="op">=</span> <span class="st">"url"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments passed to <code>$app_obj()</code>.</p></dd>


<dt><code>bookmark_store</code></dt>
<dd><p>The bookmarking storage method. Passed to
<code><a href="https://rdrr.io/pkg/shiny/man/enableBookmarking.html" class="external-link">shiny::enableBookmarking()</a></code>. If <code>"url"</code> or <code>"server"</code>, the chat state
(including current query) will be bookmarked. Default is <code>"url"</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Invisibly returns a list of session-specific values:</p><ul><li><p><code>df</code>: The final filtered data frame</p></li>
<li><p><code>sql</code>: The final SQL query string</p></li>
<li><p><code>title</code>: The final title</p></li>
<li><p><code>client</code>: The session-specific chat client instance</p></li>
</ul></div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
library(querychat)

qc &lt;- QueryChat$new(mtcars)
qc$app()
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-app_obj"></a><div class="section">
<h3 id="method-app-obj-">Method <code>app_obj()</code><a class="anchor" aria-label="anchor" href="#method-app-obj-"></a></h3>
<p>A streamlined Shiny app for chatting with data</p>
<p>Creates a Shiny app designed for chatting with data, with:</p><ul><li><p>A sidebar containing the chat interface</p></li>
<li><p>A card displaying the current SQL query</p></li>
<li><p>A card displaying the filtered data table</p></li>
<li><p>A reset button to clear the query</p></li>
</ul><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">app_obj</span><span class="op">(</span><span class="va">...</span>, bookmark_store <span class="op">=</span> <span class="st">"url"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Additional arguments (currently unused).</p></dd>


<dt><code>bookmark_store</code></dt>
<dd><p>The bookmarking storage method. Passed to
<code><a href="https://rdrr.io/pkg/shiny/man/enableBookmarking.html" class="external-link">shiny::enableBookmarking()</a></code>. If <code>"url"</code> or <code>"server"</code>, the chat state
(including current query) will be bookmarked. Default is <code>"url"</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A Shiny app object that can be run with <code><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">shiny::runApp()</a></code>.</p>
</div>
<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
library(querychat)

qc &lt;- QueryChat$new(mtcars)
app &lt;- qc$app_obj()
shiny::runApp(app)
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-sidebar"></a><div class="section">
<h3 id="method-sidebar-">Method <code><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">sidebar()</a></code><a class="anchor" aria-label="anchor" href="#method-sidebar-"></a></h3>
<p>Create a sidebar containing the querychat UI.</p>
<p>This method generates a <code><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">bslib::sidebar()</a></code> component containing the chat
interface, suitable for use with <code><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">bslib::page_sidebar()</a></code> or similar layouts.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">sidebar</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">400</span>,</span>
<span>  height <span class="op">=</span> <span class="st">"100%"</span>,</span>
<span>  fillable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Additional arguments passed to <code><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">bslib::sidebar()</a></code>.</p></dd>


<dt><code>width</code></dt>
<dd><p>Width of the sidebar in pixels. Default is 400.</p></dd>


<dt><code>height</code></dt>
<dd><p>Height of the sidebar. Default is "100%".</p></dd>


<dt><code>fillable</code></dt>
<dd><p>Whether the sidebar should be fillable. Default is <code>TRUE</code>.</p></dd>


<dt><code>id</code></dt>
<dd><p>Optional ID for the QueryChat instance. If not provided,
will use the ID provided at initialization. If using <code>$sidebar()</code> in
a Shiny module, you'll need to provide <code>id = ns("your_id")</code> where <code>ns</code>
is the namespacing function from <code><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">shiny::NS()</a></code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A <code><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">bslib::sidebar()</a></code> UI component.</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
qc &lt;- QueryChat$new(mtcars)

ui &lt;- page_sidebar(
  qc$sidebar(),
  # Main content here
)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-ui"></a><div class="section">
<h3 id="method-ui-">Method <code>ui()</code><a class="anchor" aria-label="anchor" href="#method-ui-"></a></h3>
<p>Create the UI for the querychat chat interface.</p>
<p>This method generates the chat UI component. Typically you'll use
<code>$sidebar()</code> instead, which wraps this in a sidebar layout.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="va">...</span>, id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Additional arguments passed to <code><a href="https://posit-dev.github.io/shinychat/r/reference/chat_ui.html" class="external-link">shinychat::chat_ui()</a></code>.</p></dd>


<dt><code>id</code></dt>
<dd><p>Optional ID for the QueryChat instance. If not provided,
will use the ID provided at initialization. If using <code>$ui()</code> in a Shiny
module, you'll need to provide <code>id = ns("your_id")</code> where <code>ns</code> is the
namespacing function from <code><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">shiny::NS()</a></code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>A UI component containing the chat interface.</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
qc &lt;- QueryChat$new(mtcars)

ui &lt;- fluidPage(
  qc$ui()
)
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-server"></a><div class="section">
<h3 id="method-server-">Method <code>server()</code><a class="anchor" aria-label="anchor" href="#method-server-"></a></h3>
<p>Initialize the querychat server logic.</p>
<p>This method must be called within a Shiny server function. It sets up
the reactive logic for the chat interface and returns session-specific
reactive values.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span></span>
<span>  enable_bookmarking <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  session <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/domains.html" class="external-link">getDefaultReactiveDomain</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>enable_bookmarking</code></dt>
<dd><p>Whether to enable bookmarking for the chat
state. Default is <code>FALSE</code>. When enabled, the chat state (including
current query, title, and chat history) will be saved and restored
with Shiny bookmarks. This requires that the Shiny app has bookmarking
enabled via <code><a href="https://rdrr.io/pkg/shiny/man/enableBookmarking.html" class="external-link">shiny::enableBookmarking()</a></code> or the <code>enableBookmarking</code>
parameter of <code><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shiny::shinyApp()</a></code>.</p></dd>


<dt><code>...</code></dt>
<dd><p>Ignored.</p></dd>


<dt><code>id</code></dt>
<dd><p>Optional module ID for the QueryChat instance. If not provided,
will use the ID provided at initialization. When used in Shiny modules,
this <code>id</code> should match the <code>id</code> used in the corresponding UI function
(i.e., <code>qc$ui(id = ns("your_id"))</code> pairs with <code>qc$server(id = "your_id")</code>).</p></dd>


<dt><code>session</code></dt>
<dd><p>The Shiny session object.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>A list containing session-specific reactive values and the chat
client with the following elements:</p><ul><li><p><code>df</code>: Reactive expression returning the current filtered data frame</p></li>
<li><p><code>sql</code>: Reactive value for the current SQL query string</p></li>
<li><p><code>title</code>: Reactive value for the current title</p></li>
<li><p><code>client</code>: The session-specific chat client instance</p></li>
</ul></div>
<div class="section">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
qc &lt;- QueryChat$new(mtcars)

server &lt;- function(input, output, session) {
  qc_vals &lt;- qc$server(enable_bookmarking = TRUE)

  output$data &lt;- renderDataTable(qc_vals$df())
  output$query &lt;- renderText(qc_vals$sql())
  output$title &lt;- renderText(qc_vals$title() %||% "No Query")
}
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-generate_greeting"></a><div class="section">
<h3 id="method-generate-greeting-">Method <code>generate_greeting()</code><a class="anchor" aria-label="anchor" href="#method-generate-greeting-"></a></h3>
<p>Generate a welcome greeting for the chat.</p>
<p>By default, <code>QueryChat$new()</code> generates a greeting at the start of every
new conversation, which is convenient for getting started and
development, but also might add unnecessary latency and cost. Use this
method to generate a greeting once and save it for reuse.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">generate_greeting</span><span class="op">(</span>echo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"output"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>echo</code></dt>
<dd><p>Whether to print the greeting to the console. Options are
<code>"none"</code> (default, no output) or <code>"output"</code> (print to console).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>The greeting string in Markdown format.</p>
</div>
<div class="section">
<h4 id="examples-6">Examples<a class="anchor" aria-label="anchor" href="#examples-6"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
# Create QueryChat object
qc &lt;- QueryChat$new(mtcars)

# Generate a greeting and save it
greeting &lt;- qc$generate_greeting()
writeLines(greeting, "mtcars_greeting.md")

# Later, use the saved greeting
qc2 &lt;- QueryChat$new(mtcars, greeting = "mtcars_greeting.md")
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-QueryChat-cleanup"></a><div class="section">
<h3 id="method-cleanup-">Method <code>cleanup()</code><a class="anchor" aria-label="anchor" href="#method-cleanup-"></a></h3>
<p>Clean up resources associated with the data source.</p>
<p>This method releases any resources (e.g., database connections)
associated with the data source. Call this when you are done using
the QueryChat object to avoid resource leaks.</p>
<p>Note: If <code>auto_cleanup</code> was set to <code>TRUE</code> in the constructor,
this will be called automatically when the Shiny app stops.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">cleanup</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>Invisibly returns <code>NULL</code>. Resources are cleaned up internally.</p>
</div>

</div><p></p><hr><a id="method-QueryChat-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">QueryChat</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage with a data frame</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">app</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a custom greeting</span></span></span>
<span class="r-in"><span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="st">"Welcome! Ask me about the mtcars dataset."</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span>, greeting <span class="op">=</span> <span class="va">greeting</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a specific LLM provider</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span>, client <span class="op">=</span> <span class="st">"anthropic/claude-sonnet-4-5"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a greeting for reuse</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">generate_greeting</span><span class="op">(</span>echo <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Save greeting for next time</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">greeting</span>, <span class="st">"mtcars_greeting.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$new`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With options</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>  greeting <span class="op">=</span> <span class="st">"Welcome to the mtcars explorer!"</span>,</span></span>
<span class="r-in"><span>  client <span class="op">=</span> <span class="st">"openai/gpt-4o"</span>,</span></span>
<span class="r-in"><span>  data_description <span class="op">=</span> <span class="st">"Motor Trend car road tests dataset"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With database</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">":memory:"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"mtcars"</span>, <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">conn</span>, <span class="st">"mtcars"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$app`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://posit-dev.github.io/querychat/pkg-r">querychat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qc</span><span class="op">$</span><span class="fu">app</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$app_obj`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://posit-dev.github.io/querychat/pkg-r">querychat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">app_obj</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$sidebar`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">qc</span><span class="op">$</span><span class="fu">sidebar</span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Main content here</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$ui`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">qc</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$server`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">qc_vals</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span>enable_bookmarking <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">output</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderDataTable.html" class="external-link">renderDataTable</a></span><span class="op">(</span><span class="va">qc_vals</span><span class="op">$</span><span class="fu">df</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">output</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="va">qc_vals</span><span class="op">$</span><span class="fu">sql</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">output</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="va">qc_vals</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Control.html" class="external-link">%||%</a></span> <span class="st">"No Query"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `QueryChat$generate_greeting`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create QueryChat object</span></span></span>
<span class="r-in"><span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a greeting and save it</span></span></span>
<span class="r-in"><span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="va">qc</span><span class="op">$</span><span class="fu">generate_greeting</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">greeting</span>, <span class="st">"mtcars_greeting.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Later, use the saved greeting</span></span></span>
<span class="r-in"><span><span class="va">qc2</span> <span class="op">&lt;-</span> <span class="va">QueryChat</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mtcars</span>, greeting <span class="op">=</span> <span class="st">"mtcars_greeting.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://garrickadenbuie.com" class="external-link">Garrick Aden-Buie</a>, <a href="https://github.com/jcheng5" class="external-link">Joe Cheng</a>, <a href="https://cpsievert.me" class="external-link">Carson Sievert</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

